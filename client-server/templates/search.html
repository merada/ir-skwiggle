{% extends "layout.html" %}
{% block title %}Search{% endblock %}

{% block content %}
  <div class="container col-lg-2">
    <form class="form-group" action="{{ url_for('searchFacet') }}">
      <div class="form-group">
        <label for="select" class="col-lg-2 control-label"></label>
        <div class="col-lg-10">
          <!-- So many for loops :( :( :(  -->
            {% for facetfield in response.facet_counts['facet_fields'] %}
              {% for element in response.facet_counts['facet_fields'][facetfield] %}
                {% if response.facet_counts['facet_fields'][facetfield][element] > 0 %}
                  {{ facetfield }}
                  <select class="form-control" id="select" padding="10px">
                  {% break %}
                {% endif %}
              {% endfor %}
              <option>All</option>
              {% for element in response.facet_counts['facet_fields'][facetfield] %}
                {% if response.facet_counts['facet_fields'][facetfield][element] > 0 %}
                  <option>{{ element }} ({{response.facet_counts['facet_fields'][facetfield][element]}})</option>
                {% endif %}
              {% endfor %}
                  </select>
              {% for element in response.facet_counts['facet_fields'][facetfield] %}
                {% if response.facet_counts['facet_fields'][facetfield][element] > 0 %}
                  <br>
                  {% break %}
                {% endif %}
              {% endfor %}
            {% endfor %}
        </div>
      </div>
      <div class="form-group">
        <button class="btn btn-default">Cancel</button>
        <button type="submit" class="btn btn-primary">Submit</button>
      </div>
    </form>
  </div>
  <div class="container col-lg-9">
      {% for result in response %}
        <blockquote>
          {% if result.identifier %}
            <h4><a href="{{ result.identifier[0] }}">{{ result.title[0][:50] }}
              {% if result.title[0][50:51] %} 
                ...
              {% endif %}</a> </h4>
          {% else %}
            <h4><p class="text-primary">{{ result.title[0][:50] }}...</p></h4>
          {% endif %}

          <h6>

          {% if result.creator %}
            {{ result.creator[0] }}
          {% else %}
            <h5>Unknown creator</h5>
          {% endif %}

          {% if result.description %}
            <div class="field"> {{ result.description[0][:300] }} </div>
          {% else %}
            <div class="field"> No description found. </div>
          {% endif %}
          {% if result.identifier %}
            <div class="field"> <a class="text-success" href="{{ result.identifier[0] }}">{{ result.identifier[0] }}</a> </div>
          {% else %}
            <div class="field"> <p class="text-success"> No identifier found. </p></div>
          {% endif %}

          </h6>

        </blockquote>

          {% else %}
            <h3>No results found.</h3>        
      {% endfor %}
      {{ pagination.links|safe }}
  </div>
{% endblock %}
